---
phase: 06-data-hygiene-reliability
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - dolphin/models.py
  - dolphin/sheets_sync.py
autonomous: true

must_haves:
  truths:
    - "Account warmup status is calculated based on age and karma"
    - "Warmup status appears as a column in Google Sheet"
    - "New accounts (< 7 days OR < 10 karma) show as 'new'"
    - "Established accounts (90+ days AND 500+ karma) show as 'established'"
  artifacts:
    - path: "dolphin/models.py"
      provides: "calculate_warmup_status function"
      contains: "calculate_warmup_status"
    - path: "dolphin/sheets_sync.py"
      provides: "warmup_status column in HEADERS"
      contains: "warmup_status"
  key_links:
    - from: "dolphin/sheets_sync.py"
      to: "dolphin/models.py"
      via: "import calculate_warmup_status"
      pattern: "from models import.*calculate_warmup_status"
---

<objective>
Add account warmup status tracking based on Reddit account age and karma thresholds.

Purpose: New Reddit accounts need gradual activity ramp-up. Warmup status helps identify which accounts are safe for full activity vs need careful handling.

Output: New warmup_status column in Google Sheet showing new/warming/ready/established status.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/06-data-hygiene-reliability/06-RESEARCH.md

# Existing models and sheet sync
@dolphin/models.py
@dolphin/sheets_sync.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add calculate_warmup_status function</name>
  <files>dolphin/models.py</files>
  <action>
Add a new function `calculate_warmup_status` to models.py.

The function signature:
```python
def calculate_warmup_status(created_utc: float, total_karma: int) -> str:
```

Warmup status logic (based on research):
- "unknown": if created_utc <= 0 (invalid timestamp)
- "established": if age >= 90 days AND karma >= 500
- "ready": if age >= 30 days AND karma >= 100
- "warming": if age >= 7 days OR karma >= 10
- "new": otherwise (account is very new, needs careful handling)

Use timezone-aware datetime (match existing calculate_account_age pattern).
Calculate age in days from created_utc to now.

Return value is a string literal: "unknown", "new", "warming", "ready", or "established"
  </action>
  <verify>python3 -c "from dolphin.models import calculate_warmup_status; print(calculate_warmup_status(0, 0))"</verify>
  <done>calculate_warmup_status function exists and returns status strings</done>
</task>

<task type="auto">
  <name>Task 2: Add warmup_status column to Google Sheet</name>
  <files>dolphin/sheets_sync.py</files>
  <action>
Update sheets_sync.py to include warmup_status in the sheet.

1. Add import for calculate_warmup_status:
   ```python
   from models import AccountResult, calculate_account_age, calculate_warmup_status
   ```

2. Update HEADERS list - add "warmup_status" after "account_age" (position 8, shifting later columns).
   New HEADERS order (13 columns A-M):
   ```python
   HEADERS = [
       "profile_id",      # A
       "username",        # B
       "status",          # C
       "total_karma",     # D
       "comment_karma",   # E
       "link_karma",      # F
       "account_age",     # G
       "warmup_status",   # H (NEW)
       "owner",           # I
       "proxy",           # J
       "proxy_health",    # K
       "karma_delta",     # L
       "checked_at",      # M
   ]
   ```

3. Update _to_row() to include warmup_status:
   - Calculate: `warmup_status = calculate_warmup_status(result.reddit.created_utc, result.reddit.total_karma)`
   - Insert in correct position (after account_age)

4. Update cell ranges throughout the file:
   - _ensure_headers: "A1:L1" -> "A1:M1"
   - _update_summary_row: "A2:L2" -> "A2:M2"
   - Summary row array needs an extra empty string for warmup_status position
   - sync_to_sheet batch_update range: "A{row}:L{row}" -> "A{row}:M{row}"
  </action>
  <verify>python3 -c "from dolphin.sheets_sync import HEADERS; print(len(HEADERS), 'warmup_status' in HEADERS)"</verify>
  <done>HEADERS has 13 columns and includes warmup_status</done>
</task>

</tasks>

<verification>
1. `python3 -c "from dolphin.models import calculate_warmup_status; print(calculate_warmup_status(1700000000, 500))"` - returns status
2. `python3 -c "from dolphin.sheets_sync import HEADERS; print(HEADERS)"` - shows 13 columns with warmup_status
3. `grep -q "warmup_status" dolphin/models.py` - function exists
4. `grep -q "A1:M1" dolphin/sheets_sync.py` - updated column ranges
</verification>

<success_criteria>
- calculate_warmup_status returns correct status for all thresholds:
  - created_utc=0 -> "unknown"
  - age < 7 days, karma < 10 -> "new"
  - age >= 7 days OR karma >= 10 -> "warming"
  - age >= 30 days AND karma >= 100 -> "ready"
  - age >= 90 days AND karma >= 500 -> "established"
- HEADERS has 13 columns (A-M) with warmup_status in position 8
- _to_row produces 13-element list
- All sheet ranges updated to column M
</success_criteria>

<output>
After completion, create `.planning/phases/06-data-hygiene-reliability/06-02-SUMMARY.md`
</output>
